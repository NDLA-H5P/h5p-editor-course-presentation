(()=>{"use strict";const e=function(e,t){function i(i,r){var n=this;t.call(n);var a,o=e("<div>",{class:"h5p-bg-selector"}),s=e("<div>",{class:"h5p-bg-selector-description",appendTo:o}),d=e("<div>",{class:"h5p-bg-selector-content",appendTo:o}),l=e("<div>",{class:"h5p-bg-selector-reset-area",appendTo:o});n.passReadies=!0,n.children=[],r=r||!1;var c=[H5PEditor.t("H5PEditor.CoursePresentation","setImageBackground",{}),H5PEditor.t("H5PEditor.CoursePresentation","setColorFillBackground",{})],p=function(){var e=n.getSettings();e||(e={type:"reset"});var t=r?i:i.filter(".global");t.removeClass("has-background").css("background","").css("background-image","").css("background-color",""),"image"===e.type?t.addClass("has-background").css("background-image","url("+e.value+")"):"bgColor"===e.type&&t.addClass("has-background").css("background-color",e.value)},h=function(){return n.children[0]},u=function(){r?(i.addClass("global"),n.trigger("turnedGlobal")):p(),a&&a.removeClass("show")};n.addBackground=function(){var e=n.getSettings();e?(r&&e.value&&i.removeClass("global"),p(),a&&a.addClass("show")):u()},n.addBgSelector=function(e,t,a,s){var l;return s=s||{},o.toggleClass("single",s.isSingle).toggleClass("show",s.isVisible),H5PEditor.processSemanticsChunk(H5P.jQuery.makeArray(e),t,d,n),(l=h()).on("backgroundAdded",(function(){n.addBackground()})),l.on("backgroundRemoved",(function(){u()})),h().setRadioLabels(c),r&&!n.getSettings()?(i.addClass("global"),n.trigger("turnedGlobal")):p(),s.index&&s.index>0&&s.index<a.children().length?o.insertAfter(a.children(".single").eq(s.index-1)):o.appendTo(a),n},n.addResetButton=function(t){return t=t||H5PEditor.t("H5PEditor.CoursePresentation","resetToDefault"),a=e("<button>",{html:t,class:"h5p-background-selector-reset"}).click((function(){h().resetCheckedOption()})),n.getSettings()&&a.addClass("show"),l.children().each((function(){e(this).remove()})),a.appendTo(l),n},n.setDescription=function(e){return s.html(e),n},n.validate=function(){return h().validate()},n.getSettings=function(){return h().getStoredOption()},n.setBackgroundSlides=function(e){return i=e,n},n.removeElement=function(){return o&&o.remove(),n},n.updateColorPicker=function(){return h().reflow(),n},n.getSelectedIndex=function(){return h().getSelectedIndex()},n.setSelectedIndex=function(e){return h().setSelectedIndex(e),n}}return i.prototype=Object.create(t.prototype),i.prototype.constructor=i,i}(H5P.jQuery,H5P.EventDispatcher),t=function(t,i){function r(r,n,a,o,s){var d=this;i.call(d);var l,c=!1,p=[],h=0,u=t('<div class="h5p-background-selector">'),m=t('<div class="h5p-background-selector-title">').html(H5PEditor.t("H5PEditor.CoursePresentation","slideBackground",{})).appendTo(u);t("<div>",{class:"h5p-background-selector-close",role:"button",tabIndex:"0",click:function(){r.slideControls.$background.click()},keydown:function(e){32===e.which&&(t(this).click(),e.preventDefault())}}).prependTo(m);var f,v,g=t("<div>").appendTo(u),b=t('<div class="h5p-background-selector-content-wrapper">').appendTo(u),y=H5PEditor.CoursePresentation.findField("slideBackgroundSelector",o.field.fields),w=function(t,i){var r=s.slides[i],a=new e(n.children().eq(i),!0);return l.setBackgroundSlides(n.children()),a.on("turnedGlobal",(function(){l.addBackground()})),a.addBgSelector(y,r,t,{isSingle:!0,isVisible:0===i,index:i}),p.splice(i,0,a),a},C=function(e){var t=g.children().eq(e.index());e.hasClass("show")&&t.hasClass("active")||(b.children().removeClass("show"),e.addClass("show"),g.children().removeClass("active").attr("aria-pressed",!1),t.addClass("active").attr("aria-pressed",!0),k())},P=function(e,i){var r=i?" active":"",n=t("<div>",{class:"h5p-slide-selector-content"+(i?" show":"")}).appendTo(b),a=t("<a>",{class:"h5p-slide-selector-option"+r,href:"javascript:void(0)",html:e,on:{click:function(){C(n)},keypress:function(e){if(32===e.which)return C(n),!1}},appendTo:g});return i&&a.attr("aria-pressed",!0),n},k=function(){$()?p[h].updateColorPicker():l.updateColorPicker()},$=function(){return v.hasClass("show")};d.appendTo=function(t){var i,o;return d.$wrapper=t,i=H5PEditor.t("H5PEditor.CoursePresentation","template"),o=H5PEditor.t("H5PEditor.CoursePresentation","currentSlide"),f=P(i,!0),l=new e(n.children()).addBgSelector(a,s,f,{isVisible:!0}).setDescription(H5PEditor.t("H5PEditor.CoursePresentation","templateDescription",{":currentSlide":o})).addResetButton(),v=P(o,!1),n.children().each((function(e){w(v,e).setDescription(H5PEditor.t("H5PEditor.CoursePresentation","currentSlideDescription",{":template":i})).addResetButton(H5PEditor.t("H5PEditor.CoursePresentation","resetToTemplate"))})),p[0].getSettings()&&C(v),g.children().css("width",100/g.children().length+"%"),r.cp.on("changedSlide",(function(e){h!==e.data&&function(e){if(!(e>=p.length)){v.children().removeClass("show"),v.children().eq(e).addClass("show");var t=p[e].getSettings()?v:f;C(t),h=e,k()}}(e.data)})),r.on("sortSlide",(function(e){!function(e){if(h+e>=0&&h+e<n.children().length){var t=p[h+e];p[h+e]=p[h],p[h]=t;var i=h+(e<0?0:e),r=h+(e<0?e:0);v.children().eq(i).insertBefore(v.children().eq(r)),h+=e}}(e.data)})),r.on("removeSlide",(function(e){var t;t=e.data,p.splice(t,1).forEach((function(e){e.removeElement()}))})),r.on("addedSlide",(function(e){!function(e){var t,i;t=e,(i=s.slides[t].slideBackgroundSelector)&&(i.fillSlideBackground&&!i.fillSlideBackground.length&&(i.fillSlideBackground=void 0),i.imageSlideBackground&&!i.imageSlideBackground.path&&(i.imageSlideBackground=void 0)),w(v,e).setDescription(H5PEditor.t("H5PEditor.CoursePresentation","currentSlideDescription",{":template":H5PEditor.t("H5PEditor.CoursePresentation","template")})).addResetButton(H5PEditor.t("H5PEditor.CoursePresentation","resetToTemplate"));var r=p[e-1].getSelectedIndex();p[e].setSelectedIndex(r)}(e.data)})),u.appendTo(t),d},d.open=function(){return d.$wrapper&&(d.$wrapper.removeClass("hidden"),c=!0),d},d.close=function(){return d.$wrapper&&(d.$wrapper.addClass("hidden"),c=!1),d},d.toggleOpen=function(){return d.$wrapper&&(c?d.close():d.open(),k()),d},d.ready=function(){return!0},d.validate=function(){var e=!0;return e&=l.validate(),p.forEach((function(t){e&=t.validate()})),e}}return r.prototype=Object.create(i.prototype),r.prototype.constructor=r,r}(H5P.jQuery,H5P.EventDispatcher),i=function(){const e=String.raw;return class{constructor(e,t){this.availableRatios=e.map((e=>this.ratioToRatioView(e))),this.selectedRatio=this.availableRatios[0],this.modal=this.createAspectRatioModal(),this.onSubmit=t}reset(){this.modal&&(this.modal.parentElement.removeChild(this.modal),delete this.modal),this.selectedRatio=this.availableRatios[0],this.modal=this.createAspectRatioModal()}ratioToRatioView(e){const[t,i]=e.ratio.split("-"),r=Number.parseInt(t,10),n=Number.parseInt(i,10);return(Number.isNaN(r)||Number.isNaN(n)||r<=0||n<=0)&&console.error(`The ratio '${e.ratio}' is malformed. The ratio should be on the format 'width-height'.`),{ratio:e.ratio,illustration:this.createRatioIllustration(r,n,e.label)}}createRatioIllustration(t,i,r){return e`
      <div class="aspect-ratio-modal-illustration-container">
        <div class="aspect-ratio-modal-illustration" style="padding-top: ${i/t*100}%">
          <span class="aspect-ratio-modal-illustration-label">${r}</span>
        </div>
      </div>`}createRatioButton(e,t,i){const r=document.createElement("div");r.className="aspect-ratio-modal-ratio-radio-container";const n=`aspect-ratio-modal-ratio-${i}`,a=document.createElement("input");a.type="radio",a.addEventListener("change",(()=>this.setRatio(e))),a.checked=t,a.className="aspect-ratio-modal-ratio-radio",a.name="aspect-ratio-modal-ratio",a.id=n,r.appendChild(a);const o=document.createElement("label");return o.innerHTML=e.illustration,o.className="aspect-ratio-modal-ratio",o.setAttribute("for",n),r.appendChild(o),r}setRatio(e){this.selectedRatio=e}createAspectRatioModal(){const e=document.createElement("div");e.className="aspect-ratio-modal-container";const t=document.createElement("section");t.className="aspect-ratio-modal";const i=document.createElement("header");i.className="aspect-ratio-modal-header";const r=document.createElement("h1");r.className="aspect-ratio-modal-title",r.textContent=H5PEditor.t("H5PEditor.InteraktivTavle","aspectRatioTitle");const n=document.createElement("p");n.setAttribute("role","doc-subtitle"),n.className="aspect-ratio-modal-subtitle",n.textContent=H5PEditor.t("H5PEditor.InteraktivTavle","aspectRatioSubtitle"),i.appendChild(r),i.appendChild(n),t.appendChild(i);const a=document.createElement("div");a.className="aspect-ratio-modal-ratios",this.availableRatios.map(((e,t)=>this.createRatioButton(e,0===t,t))).map((e=>a.appendChild(e))),t.appendChild(a);const o=document.createElement("footer");o.className="aspect-ratio-modal-footer";const s=document.createElement("button");return s.type="button",s.className="aspect-ratio-submit-button",s.addEventListener("click",(()=>this.onSubmitClick())),s.textContent=H5PEditor.t("H5PEditor.InteraktivTavle","aspectRatioSubmit"),o.appendChild(s),t.appendChild(o),e.appendChild(t),e}show(){document.body.appendChild(this.modal)}hide(){this.reset()}onSubmitClick(){this.onSubmit(this.selectedRatio),this.hide()}}}();var r=window.H5PEditor||{};r.CoursePresentation=function(e,t,n,a){var o=this;H5P.DragNBar.FormManager.call(this,e,{doneButtonLabel:r.t("H5PEditor.InteraktivTavle","done"),deleteButtonLabel:r.t("H5PEditor.InteraktivTavle","remove"),expandBreadcrumbButtonLabel:r.t("H5PEditor.InteraktivTavle","expandBreadcrumbButtonLabel"),collapseBreadcrumbButtonLabel:r.t("H5PEditor.InteraktivTavle","collapseBreadcrumbButtonLabel")},"coursepresentation");const s=void 0===n;s&&a(t,n={slides:[{elements:[],keywords:[],aspectRatio:this.defaultAspectRatio}],defaultAspectRatio:this.defaultAspectRatio}),this.parent=e,this.field=t,this.params=n,this.elements=[],this.slideRatio=1.9753,this.passReadies=!0,e.ready((function(){s&&new i([{ratio:"4-3",label:r.t("H5PEditor.InteraktivTavle","aspectRatioLandscape")},{ratio:"3-4",label:r.t("H5PEditor.InteraktivTavle","aspectRatioPortrait")}],(e=>o.setRatio(e.ratio))).show(),o.passReadies=!1,r.findField("override/activeSurface",e).on("checked",(function(){var e=parseFloat(window.getComputedStyle(o.cp.$current[0]).height);o.cp.$container.addClass("h5p-active-surface"),o.cp.$progressbar.remove();var t=parseFloat(window.getComputedStyle(o.cp.$current[0]).height),i=(t-e)/t;o.slideRatio=r.CoursePresentation.RATIO_SURFACE,o.updateElementSizes(1-i)}))})),void 0!==r.InteractiveVideo&&r.InteractiveVideo.disableGuidedTour(),H5P.externalDispatcher.on("datainclipboard",(function(e){if(o.libraries){var t=!e.data.reset;t&&(t=o.canPaste(H5P.getClipboard())),o.dnb.setCanPaste(t)}}))},r.CoursePresentation.allAspectRatios=["4-3","3-4","16-9","9-16"],r.CoursePresentation.prototype.defaultAspectRatio=r.CoursePresentation.allAspectRatios[0],r.CoursePresentation.prototype=Object.create(H5P.DragNBar.FormManager.prototype),r.CoursePresentation.prototype.constructor=r.CoursePresentation,r.CoursePresentation.clipboardKey="H5PEditor.InteraktivTavle",r.CoursePresentation.prototype.updateElementSizes=function(e){for(var t=this.cp.$slidesWrapper.children(),i=0;i<this.params.slides.length;i++)for(var r=this.params.slides[i],n=t.eq(i).children(),a=0;a<r.elements.length;a++){var o=r.elements[a];o.height*=e,o.y*=e,n.eq(a).css({height:o.height+"%",top:o.y+"%"})}},r.CoursePresentation.prototype.addElement=function(e,t={},i={}){var r;if(e instanceof String||"string"==typeof e||(r=e),!r){if(r={x:30,y:30,width:40,height:40},"GoToSlide"===e)r.goToSlide=1;else switch(r.action=t.action?t.action:{library:e,params:i},r.action.subContentId=H5P.createUUID(),e.split(" ")[0]){case"H5P.Audio":r.width=2.577632696,r.height=5.091753604,r.action.params.fitToWrapper=!0;break;case"H5P.DragQuestion":r.width=50,r.height=50;break;case"H5P.Video":r.width=50,r.height=50.5553;break;case"H5P.InteractiveVideo":r.width=50,r.height=64.5536}t.width&&t.height&&!t.displayAsButton&&(r.width=t.width,r.height=t.height*this.slideRatio),t.displayAsButton&&(r.displayAsButton=!0)}t.pasted&&(r.pasted=!0),r={...r,...i};var n=this.cp.$current.index(),a=this.params.slides[n];if(void 0===a.elements)a.elements=[r];else{var o=window.getComputedStyle(this.dnb.$container[0]),s=parseFloat(o.width),d=parseFloat(o.height),l=s/100,c={x:r.x*l,y:r.y*l/this.slideRatio};this.dnb.avoidOverlapping(c,{width:r.width/100*s,height:r.height/100*d}),r.x=c.x/l,r.y=c.y/l*this.slideRatio,a.elements.push(r)}this.cp.$boxWrapper.add(this.cp.$boxWrapper.find(".h5p-presentation-wrapper:first")).css("overflow","visible");const p=this.cp.children[n].addChild(r);return this.cp.attachElement(r,p.instance,this.cp.$current,n)},r.CoursePresentation.prototype.appendTo=function(e){var i=this;this.$item=r.$(this.createHtml()).appendTo(e),this.$editor=this.$item.children(".editor"),this.$errors=this.$item.children(".h5p-errors");var n=this.parent instanceof ns.Library?this.parent.params.params:this.parent.params;n&&n.override&&!0===n.override.activeSurface&&(this.slideRatio=r.CoursePresentation.RATIO_SURFACE),this.cp=new H5P.InteraktivTavle(n,r.contentId,{cpEditor:this}),this.cp.attach(this.$editor),this.cp.$wrapper.is(":visible")&&this.cp.trigger("resize");var a=r.$("<div>",{class:"h5p-settings-wrapper hidden",appendTo:i.cp.$boxWrapper.children(".h5p-presentation-wrapper")});i.initializeDNB();var o=r.CoursePresentation.findField("globalBackgroundSelector",this.field.fields),s=r.CoursePresentation.findField("slides",this.field.fields);this.backgroundSelector=new t(i,i.cp.$slidesWrapper,o,s,i.params).appendTo(a);var d={$add:r.$('<a href="#" aria-label="'+r.t("H5PEditor.InteraktivTavle","newSlide")+'" class="h5p-slidecontrols-button h5p-slidecontrols-button-add"></a>'),$clone:r.$('<a href="#" aria-label="'+r.t("H5PEditor.InteraktivTavle","cloneSlide")+'" class="h5p-clone-slide h5p-slidecontrols-button h5p-slidecontrols-button-clone"></a>'),$background:r.$('<a href="#" aria-label="'+r.t("H5PEditor.InteraktivTavle","backgroundSlide")+'" class="h5p-slidecontrols-button h5p-slidecontrols-button-background"></a>'),$sortLeft:r.$('<a href="#" aria-label="'+r.t("H5PEditor.InteraktivTavle","sortSlide",{":dir":"left"})+'" class="h5p-slidecontrols-button h5p-slidecontrols-button-sort-left"></a>'),$sortRight:r.$('<a href="#" aria-label="'+r.t("H5PEditor.InteraktivTavle","sortSlide",{":dir":"right"})+'" class="h5p-slidecontrols-button h5p-slidecontrols-button-sort-right"></a>'),$delete:r.$('<a href="#" aria-label="'+r.t("H5PEditor.InteraktivTavle","removeSlide")+'" class="h5p-slidecontrols-button h5p-slidecontrols-button-delete"></a>')};this.slideControls=d,r.$('<div class="h5p-slidecontrols">').append([d.$add,d.$clone,d.$background,d.$sortLeft,d.$sortRight,d.$delete]).appendTo(this.cp.$footer.children(".h5p-footer-right-adjusted:first")).children("a:first").click((function(){return i.addSlide(),i.updateSlidesSidebar(),!1})).next().click((function(){var e=H5P.cloneObject(i.params.slides[i.cp.$current.index()],!0);return e.keywords=[],i.addSlide(e),H5P.ContinuousText.Engine.run(i),i.updateSlidesSidebar(),!1})).next().click((function(){return i.backgroundSelector.toggleOpen(),r.$(this).toggleClass("active"),!1})).next().click((function(){return i.sortSlide(i.cp.$current.prev(),-1),!1})).next().click((function(){return i.sortSlide(i.cp.$current.next(),1),!1})).next().click((function(){var e=i.cp.$current.index();return!1!==i.removeSlide()&&i.trigger("removeSlide",e),i.updateSlidesSidebar(),!1})),this.cp.activeSurface&&(this.cp.$container.addClass("h5p-active-surface"),this.cp.$progressbar.remove()),H5P.$window.on("resize",(function(){i.cp.trigger("resize")})),this.updateSlidesSidebar()},r.CoursePresentation.prototype.setRatio=function(e){this.cp.slides.forEach((t=>t.aspectRatio=e)),this.cp.defaultAspectRatio=e,this.cp.resize()},r.CoursePresentation.prototype.addDNBButton=function(e,t){var i=this;t=t||{};var r=e.name.split(".")[1].toLowerCase();return{id:t.id||r,title:void 0===t.title?e.title:t.title,createElement:function(){return i.addElement(e.uberName,H5P.jQuery.extend(!0,{},t))}}},r.CoursePresentation.prototype.addDNBButtonGroup=function(e,t){var i=this;const r={id:e.name.split(".")[1].toLowerCase(),title:t.dropdown.title||e.title,titleGroup:t.dropdown.titleGroup,type:"group",buttons:[]};return t.buttons.forEach((function(t){const n={id:t.id,title:t.title,width:t.width,height:t.height,action:{library:e.uberName,params:t.params||{}}};r.buttons.push(i.addDNBButton(e,n))})),r},r.CoursePresentation.prototype.setContainerEm=function(e){this.containerEm=e,void 0!==this.dnb&&void 0!==this.dnb.dnr&&this.dnb.dnr.setContainerEm(this.containerEm)},r.CoursePresentation.prototype.initializeDNB=function(){var e=this;this.$bar=r.$('<div class="h5p-dragnbar">'+r.t("H5PEditor.InteraktivTavle","loading")+"</div>").insertBefore(this.cp.$boxWrapper);var t=r.CoursePresentation.findField("slides",this.field.fields),i=r.CoursePresentation.findField("elements",t.field.fields).field.fields,n=r.CoursePresentation.findField("action",i);const a={title:"",width:14.09,height:14.09},o={title:"",width:10,height:5},s={title:"",width:5,height:10},d={params:{line:{borderWidth:1,borderStyle:"solid",borderColor:"#000"}}},l={params:{shape:{fillColor:"#fff",borderWidth:0,borderStyle:"solid",borderColor:"#000"}}},c=[];c.shape={dropdown:{id:"shape"},buttons:[H5P.jQuery.extend(!0,{},a,l,{id:"shape-rectangle",params:{type:"rectangle",shape:{borderRadius:0}}}),H5P.jQuery.extend(!0,{},a,l,{id:"shape-circle",params:{type:"circle"}}),H5P.jQuery.extend(!0,{},a,{id:"shape-triangle",params:{type:"triangle",svgpolygon:{fillColor:"rgb(255,255,255)",borderColor:"rgb(0,0,0)"}}}),H5P.jQuery.extend(!0,{},a,{id:"shape-pentagon",params:{type:"pentagon",svgpolygon:{fillColor:"rgb(255,255,255)",borderColor:"rgb(0,0,0)"}}}),H5P.jQuery.extend(!0,{},a,{id:"shape-hexagon",params:{type:"hexagon",svgpolygon:{fillColor:"rgb(255,255,255)",borderColor:"rgb(0,0,0)"}}}),H5P.jQuery.extend(!0,{},a,{id:"shape-cube",params:{type:"cube",svg3d:{fillColor:"white",borderColor:""}}}),H5P.jQuery.extend(!0,{},a,{id:"shape-cylinder",params:{type:"cylinder",svg3d:{fillColor:"white",borderColor:""}}}),H5P.jQuery.extend(!0,{},a,{id:"shape-cone",params:{type:"cone",svg3d:{fillColor:"white",borderColor:""}}}),H5P.jQuery.extend(!0,{},a,d,{id:"shape-horizontal-line",params:{type:"horizontal-line"}}),H5P.jQuery.extend(!0,{},a,d,{id:"shape-vertical-line",params:{type:"vertical-line"}}),H5P.jQuery.extend(!0,{},o,{id:"shape-long-arrow-right",params:{type:"long-arrow-right",svg:{fillColor:""}}}),H5P.jQuery.extend(!0,{},o,{id:"shape-long-arrow-left",params:{type:"long-arrow-left",svg:{fillColor:""}}}),H5P.jQuery.extend(!0,{},s,{id:"shape-long-arrow-up",params:{type:"long-arrow-up",svg:{fillColor:""}}}),H5P.jQuery.extend(!0,{},s,{id:"shape-long-arrow-down",params:{type:"long-arrow-down",svg:{fillColor:""}}}),H5P.jQuery.extend(!0,{},o,{id:"shape-arrows-alt-h",params:{type:"arrows-alt-h",svg:{fillColor:""}}}),H5P.jQuery.extend(!0,{},s,{id:"shape-arrows-alt-v",params:{type:"arrows-alt-v",svg:{fillColor:""}}})]},r.LibraryListCache.getLibraries(n.options,(function(t){e.libraries=t;for(var n=[],a=0;a<t.length;a++)if(!0!==t[a].restricted){const i=t[a].name.split(".")[1].toLowerCase();void 0===c[i]?n.push(e.addDNBButton(t[a])):n.push(e.addDNBButtonGroup(t[a],c[i]))}var o;r.CoursePresentation.findField("goToSlide",i)&&n.splice(5,0,{id:"gotoslide",title:r.t("H5PEditor.InteraktivTavle","goToSlide"),createElement:()=>e.addElement("H5P.Shape 1.1",void 0,{type:"rectangle",showAsHotspot:!0,title:"",shape:{borderStyle:"none",fillColor:"transparent"}})}),e.dnb=new H5P.DragNBar(n,e.cp.$current,e.$editor,{$blurHandlers:e.cp.$boxWrapper,libraries:t}),e.$dnbContainer=e.cp.$current,e.dnb.dnr.snap=10,e.dnb.dnr.setContainerEm(e.containerEm),e.elements.forEach((function(t,i){t.forEach((function(t,r){var n=e.params.slides[i].elements[r];e.addToDragNBar(t,n)}))}));var s=function(){H5P.ContinuousText.Engine.run(e),o=setTimeout(s,250)};e.dnb.dnr.on("startResizing",(function(){var t=e.params.slides[e.cp.$current.index()].elements[e.dnb.$element.index()];t.action&&"H5P.ContinuousText"===t.action.library.split(" ")[0]&&(o=setTimeout(s,250))})),e.dnb.dnr.on("stoppedResizing",(function(){var t=e.params.slides[e.cp.$current.index()].elements[e.dnb.$element.index()];t.width=e.dnb.$element.width()/(e.cp.$current.innerWidth()/100),t.height=e.dnb.$element.height()/(e.cp.$current.innerHeight()/100),t.y=parseFloat(e.dnb.$element.css("top"))/e.cp.$current.innerHeight()*100,t.x=parseFloat(e.dnb.$element.css("left"))/e.cp.$current.innerWidth()*100,t.action&&"H5P.ContinuousText"===t.action.library.split(" ")[0]&&(clearTimeout(o),H5P.ContinuousText.Engine.run(e));var i=e.cp.elementInstances[e.cp.$current.index()][e.dnb.$element.index()];H5P.trigger(i,"resize")})),e.dnb.stopMovingCallback=function(t,i){var r=e.params.slides[e.cp.$current.index()].elements[e.dnb.$element.index()];r.x=t,r.y=i},e.dnb.dnd.moveCallback=function(t,i){var r=e.params.slides[e.cp.$current.index()].elements[e.dnb.$element.index()];r.x=t,r.y=i,e.dnb.updateCoordinates()},e.dnb.dnd.releaseCallback=function(){var t=e.params.slides[e.cp.$current.index()].elements[e.dnb.$element.index()],i=e.elements[e.cp.$current.index()][e.dnb.$element.index()];e.dnb.newElement&&(e.cp.$boxWrapper.add(e.cp.$boxWrapper.find(".h5p-presentation-wrapper:first")).css("overflow",""),void 0!==t.action&&"H5P.ContinuousText"===H5P.libraryFromString(t.action.library).machineName?(H5P.ContinuousText.Engine.run(e),e.params.ct||1===e.getCTs(!1,!0).length&&e.showElementForm(i,e.dnb.$element,t)):e.showElementForm(i,e.dnb.$element,t))},e.supported=function(e){for(var i=0;i<t.length;i++)if(!0!==t[i].restricted&&t[i].uberName===e)return!0;return!1},e.dnb.on("paste",(function(t){var i=t.data,n={width:i.width,height:i.height,pasted:!0};i.from===r.CoursePresentation.clipboardKey?i.generic?e.supported(i.generic.library)?("H5P.ExportableTextArea"===i.generic.library.split(" ")[0]&&delete i.generic.params.index,e.dnb.focus(e.addElement(i.specific,n))):alert(r.t("H5P.DragNBar","unableToPaste")):e.dnb.focus(e.addElement(i.specific,n)):i.generic&&(e.supported(i.generic.library)?("button"===i.specific.displayType&&(n.displayAsButton=!0),n.action=i.generic,e.dnb.focus(e.addElement(i.generic.library,n))):alert(r.t("H5P.DragNBar","unableToPaste")))})),e.dnb.attach(e.$bar),e.dnb.setCanPaste(e.canPaste(H5P.getClipboard())),e.initKeywordInteractions(),e.trigger("librariesReady")}))},r.CoursePresentation.prototype.canPaste=function(e){if(e){if(e.from===r.CoursePresentation.clipboardKey&&(!e.generic||this.supported(e.generic.library)))return!0;if(e.generic&&this.supported(e.generic.library))return!0}return!1},r.CoursePresentation.prototype.createHtml=function(){return r.createFieldMarkup(this.field,'<div class="editor"></div>')},r.CoursePresentation.prototype.validate=function(){for(var e=!0,t=!0,i=0;i<this.elements.length;i++)if(this.elements[i])for(var r=0;r<this.elements[i].length;r++){var n=this.params.slides[i].elements[r],a=void 0!==n.action&&"H5P.ContinuousText"===n.action.library.split(" ")[0];if(!a||t){for(var o=0;o<this.elements[i][r].children.length;o++)!1===this.elements[i][r].children[o].validate()&&e&&(e=!1);a&&(this.params.ct||(this.params.ct=n.action.params.text),t=!1)}}return e&=this.backgroundSelector.validate(),H5P.ContinuousText.Engine.run(this),this.trigger("validate"),e},r.CoursePresentation.prototype.remove=function(){this.trigger("remove"),void 0!==this.dnb&&this.dnb.remove(),this.$item.remove(),this.elements.forEach((function(e){e.forEach((function(e){r.removeChildren(e.children)}))}))},r.CoursePresentation.prototype.initKeywordInteractions=function(){var e=this;e.$keywordsDNB=r.$('<ul class="h5p-dragnbar-ul h5p-dragnbar-left"><li class="h5p-slides-menu"><div title="'+r.t("H5PEditor.InteraktivTavle","slides")+'" class="h5p-dragnbar-keywords" role="button" tabindex="0"><span>'+r.t("H5PEditor.InteraktivTavle","slides")+'</span></div><div class="h5p-keywords-dropdown"><label class="h5p-keywords-enable"><input type="checkbox"/>'+r.t("H5PEditor.InteraktivTavle","showTitles")+'</label><label class="h5p-keywords-portrait"><input type="checkbox"/>'+r.t("H5PEditor.InteraktivTavle","portrait")+'</label><label class="h5p-keywords-always"><input type="checkbox"/>'+r.t("H5PEditor.InteraktivTavle","alwaysShow")+'</label><label class="h5p-keywords-hide"><input type="checkbox"/>'+r.t("H5PEditor.InteraktivTavle","autoHide")+'</label><label class="h5p-keywords-opacity"><input type="text"/> % '+r.t("H5PEditor.InteraktivTavle","opacity")+'</label><div class="h5peditor-button h5peditor-button-textual importance-low" role="button" tabindex="0" aria-disabled="false">'+r.t("H5PEditor.InteraktivTavle","ok")+"</div></div></li></ul>").prependTo(this.$bar),e.initKeywordMenu();var t=this.$bar.find(".h5p-dragnbar-keywords"),i=this.$bar.find(".h5p-keywords-dropdown"),n=!1,a=function(){n?n=!1:(t.removeClass("h5p-open"),i.removeClass("h5p-open"),e.cp.$container.off("click",a))};i.find(".h5peditor-button").click(a),this.params.keywordListEnabled||(i.children().first().siblings().hide().last().show(),e.cp.$keywordsButton.hide()),t.click((function(){i.hasClass("h5p-open")||(e.cp.$container.on("click",a),t.addClass("h5p-open"),i.addClass("h5p-open"),n=!0)})),i.click((function(){n=!0}));var o=this.$bar.find(".h5p-keywords-enable input").change((function(){e.params.keywordListEnabled=o.is(":checked"),e.params.keywordListEnabled?(e.params.keywordListAlwaysShow?(e.cp.$keywordsWrapper.show().add(e.cp.$keywordsButton).addClass("h5p-open"),e.cp.$keywordsButton.hide()):e.cp.$keywordsWrapper.add(e.cp.$keywordsButton).show(),ns.$(this).parent().siblings().show()):(e.cp.$keywordsWrapper.add(e.cp.$keywordsButton).hide(),ns.$(this).parent().siblings().hide().last().show())})),s=this.$bar.find(".h5p-keywords-always input").change((function(){var t=s.is(":checked");if(e.params.keywordListAlwaysShow=t,t?(e.params.keywordListAutoHide=!1,e.$bar.find(".h5p-keywords-hide input").attr("checked",!1).attr("disabled",!0).parent().addClass("h5p-disabled")):e.$bar.find(".h5p-keywords-hide input").attr("disabled",!1).parent().removeClass("h5p-disabled"),!e.params.keywordListEnabled)return e.cp.hideKeywords(),void e.cp.$keywordsButton.hide();e.params.keywordListAlwaysShow||e.cp.$keywordsButton.show(),e.params.keywordListAlwaysShow?(e.cp.$keywordsButton.hide(),e.cp.showKeywords()):e.params.keywordListEnabled&&(e.cp.$keywordsButton.show(),e.cp.showKeywords())})),d=this.$bar.find(".h5p-keywords-hide input").change((function(){e.params.keywordListAutoHide=d.is(":checked")})),l=this.$bar.find(".h5p-keywords-opacity input").change((function(){var t=parseInt(l.val());isNaN(t)&&(t=90),t>100&&(t=100),t<0&&(t=0),e.params.keywordListOpacity=t,e.cp.setKeywordsOpacity(t)})),c=function(t,i){void 0===e.params[t]&&(e.params[t]=i)};c("keywordListEnabled",!0),c("keywordListAlwaysShow",!1),c("keywordListAutoHide",!1),c("keywordListOpacity",90),o.attr("checked",e.params.keywordListEnabled),s.attr("checked",e.params.keywordListAlwaysShow),d.attr("checked",e.params.keywordListAutoHide),l.val(e.params.keywordListOpacity)},r.CoursePresentation.prototype.initKeywordMenu=function(){var e=this;this.cp.$keywords.find(".h5p-keyword-title").click((function(t){!1!==e.editKeyword(r.$(this))&&(t.stopPropagation(),r.$(t.target).parent().addClass("h5p-editing"))}))},r.CoursePresentation.prototype.addSlide=function(e){void 0===e&&(e={elements:[],keywords:[],aspectRatio:this.cp.defaultAspectRatio});var t=this.cp.$current.index()+1;this.params.slides.splice(t,0,e),this.elements.splice(t,0,[]),this.cp.elementInstances.splice(t,0,[]),this.cp.elementsAttached.splice(t,0,[]);const i=this.cp.addChild(e,t);i.getElement().insertAfter(this.cp.$current),this.trigger("addedSlide",t),i.appendElements(),this.cp.updateKeywordMenuFromSlides(),this.initKeywordMenu(),this.updateNavigationLine(t),this.cp.nextSlide()},r.CoursePresentation.prototype.updateNavigationLine=function(e){var t=this,i=[];this.cp.slides.forEach((function(e,r){var n=!1;void 0!==t.cp.elementInstances[r]&&t.cp.elementInstances[r].length&&t.cp.elementInstances[r].forEach((function(e){t.cp.checkForSolutions(e)&&(n=!0)})),n?i.push([[n]]):i.push([])})),this.cp.navigationLine.initProgressbar(i),this.cp.navigationLine.updateProgressBar(e),this.cp.navigationLine.updateFooter(e)},r.CoursePresentation.prototype.removeSlide=function(){var e=this.cp.$current.index(),t=this.cp.$current.add(this.cp.$currentKeyword),i=this.cp.$current.index()===this.$dnbContainer.index();if(!confirm(r.t("H5PEditor.InteraktivTavle","confirmDeleteSlide")))return!1;var n=this.elements[e];if(void 0!==n)for(var a=0;a<n.length;a++)this.removeElement(n[a],n[a].$wrapper,this.cp.elementInstances[e][a].libraryInfo&&"H5P.ContinuousText"===this.cp.elementInstances[e][a].libraryInfo.machineName);this.elements.splice(e,1);var o=this.cp.previousSlide()?-1:this.cp.nextSlide(!0)?0:void 0;if(i&&(this.$dnbContainer=this.cp.$current,this.dnb.setContainer(this.$dnbContainer)),void 0===o)return!1;H5P.ExportableTextArea.CPInterface.onDeleteSlide(e),this.params.slides.splice(e,1),this.cp.elementInstances.splice(e,1),this.cp.elementsAttached.splice(e,1),this.cp.removeChild(e),this.cp.updateKeywordMenuFromSlides(),this.initKeywordMenu(),this.updateNavigationLine(e+o),t.remove(),H5P.ContinuousText.Engine.run(this)},r.CoursePresentation.prototype.animateNavigationLine=function(e){var t=this.cp.$progressbar.find(".h5p-progressbar-part-selected");t.css("transform","translateX("+-100*e+"%)");var i=1==e?t.prev():t.next();i.css("transform","translateX("+100*e+"%)"),setTimeout((function(){t.add(i).css("transform","")}),0)},r.CoursePresentation.prototype.updateSlidesSidebar=function(){var e=this,t=this.cp.$keywords.children();t.each((function(i){var n=r.$(this);n.find(".h5p-keyword-subtitle").html(e.cp.l10n.slide+" "+(i+1)),n.find(".joubel-icon-edit").remove();var a=r.$('<a href="#" class="joubel-icon-edit h5p-hidden" title="'+r.t("H5PEditor.InteraktivTavle","edit")+'" tabindex="0"><span class="h5p-icon-circle"></span><span class="h5p-icon-pencil"></span></a>').click((function(){return r.$(this).parents('[role="menuitem"]').hasClass("h5p-current")?r.$(this).siblings("span").click():r.$(this).siblings("span").click().click(),a.siblings("textarea").select(),!1})).keydown((function(e){return-1!==[13,32].indexOf(e.which)?(r.$(this).click(),!1):!(e.which>=37&&e.which<=40)&&void 0})).blur((function(){a.addClass("h5p-hidden")})).appendTo(t.eq(i));r.$(this).focus((function(){a.removeClass("h5p-hidden")})).hover((function(){r.$(this).hasClass("h5p-editing")||a.removeClass("h5p-hidden")})).mouseleave((function(){a.addClass("h5p-hidden")})).blur((function(e){(e.relatedTarget&&"joubel-icon-edit"!==e.relatedTarget.className||!e.relatedTarget)&&a.addClass("h5p-hidden")}))}))},r.CoursePresentation.prototype.sortSlide=function(e,t){if(!e.length)return!1;var i=this.cp.$current.index(),r=void 0!==this.cp.$currentKeyword;if(-1===t){if(this.cp.$current.insertBefore(e.removeClass("h5p-previous")),r){var n=this.cp.$currentKeyword.prev();this.cp.$currentKeyword.insertBefore(n),this.swapIndexes(this.cp.$currentKeyword,n)}}else if(this.cp.$current.insertAfter(e.addClass("h5p-previous")),r){var a=this.cp.$currentKeyword.next();this.cp.$currentKeyword.insertAfter(a),this.swapIndexes(this.cp.$currentKeyword,a)}r&&this.cp.keywordMenu.scrollToKeywords();var o=i+t;return this.cp.jumpToSlide(o),H5P.ExportableTextArea.CPInterface.changeSlideIndex(t>0?i:i-1,t>0?i+1:i),this.swapCollectionIndex(this.params.slides,i,o),this.swapCollectionIndex(this.elements,i,o),this.swapCollectionIndex(this.cp.elementInstances,i,o),this.swapCollectionIndex(this.cp.elementsAttached,i,o),this.cp.moveChild(i,o),this.updateNavigationLine(o),H5P.ContinuousText.Engine.run(this),this.updateSlidesSidebar(),this.animateNavigationLine(t),this.trigger("sortSlide",t),!0},r.CoursePresentation.prototype.swapCollectionIndex=function(e,t,i){var r=e[t];e[t]=e[i],e[i]=r},r.CoursePresentation.prototype.swapIndexes=function(e,t){var i=e.attr("data-index"),r=t.attr("data-index");e.attr("data-index",r),t.attr("data-index",i)},r.CoursePresentation.prototype.editKeyword=function(e){var t=this,i=e.parent();if(!i.hasClass("h5p-current"))return!1;var n=e.text(),a=t.cp.$current.index();t.params.slides[a].keywords&&t.params.slides[a].keywords.length||(n="");var o=r.$('<a href="#" class="joubel-icon-cancel" title="'+r.t("H5PEditor.InteraktivTavle","cancel")+'"><span class="h5p-icon-circle"></span><span class="h5p-icon-cross"></span></a>'),s=r.$("<textarea></textarea>").val(n).insertBefore(e.hide()).keydown((function(e){if(13===e.keyCode)return s.blur(),i.focus(),!1;e.stopPropagation()})).keyup((function(){s.css("height",s[0].scrollHeight)})).blur((function(r){if(r.relatedTarget&&"joubel-icon-cancel"!==r.relatedTarget.className||!r.relatedTarget){var n=s.val();t.updateKeyword(n,a,e.html()),i.removeClass("h5p-editing"),e.css({display:"inline-block"}),s.add(o).remove()}})).focus();s.keyup(),o.insertAfter(s).click((function(e){e.preventDefault(),s.val(n).blur(),r.$('[role="menuitem"].h5p-current').focus()})).keydown((function(e){return-1!==[32,13].indexOf(e.which)?(r.$(this).click(),!1):!(e.which>=37&&e.which<=40)&&void 0})).blur((function(e){(e.relatedTarget&&"TEXTAREA"!==e.relatedTarget.tagName||!e.relatedTarget)&&s.blur()}))},r.CoursePresentation.prototype.updateKeyword=function(e,t,i){var n=this,a=!0;""===H5P.trim(e)&&(e=n.cp.l10n.noTitle,a=!1),n.cp.progressbarParts[t].data("keyword",i),r.$(".current-slide-title").html(i),a?n.params.slides[t].keywords=[{main:e}]:delete n.params.slides[t].keywords,r.$('[role="menuitem"].h5p-current .h5p-keyword-title').text(e)},r.CoursePresentation.prototype.generateForm=function(e,t){var i=this;if("H5P.ContinuousText"===t&&i.ct)return{$form:i.ct.element.$form,children:i.ct.element.children};var n=r.CoursePresentation.findField("slides",this.field.fields),a=r.$.extend(!0,[],r.CoursePresentation.findField("elements",n.field.fields).field.fields);if("goToSlide"===t)i.showFields(a,["title","goToSlide","goToSlideType","invisible"]);else{var o=["invisible"];"H5P.ContinuousText"===t||"H5P.Audio"===t?(o.push("displayAsButton"),o.push("buttonSize")):"H5P.Shape"===t&&o.push("solution","alwaysDisplayComments","backgroundOpacity","displayAsButton","buttonSize","buttonColor","useButtonIcon","buttonIcon"),i.hideFields(a,o)}var s={$form:H5P.jQuery("<div/>")};r.processSemanticsChunk(a,e,s.$form,i),s.children=i.children;var d=a.map((function(e){return e.type})).indexOf("library");-1!==d&&s.children[d].hide&&(s.children[d].hide(),s.$form.css("padding-top","0")),s.$form.find(".field-name-displayAsButton").each((function(){var e=ns.$(this).parent().find(".field-name-buttonSize"),t=ns.$(this).parent().find(".field-name-useButtonIcon"),i=ns.$(this).parent().find(".field-name-buttonColor"),r=ns.$(this).parent().find(".field-name-buttonIcon");ns.$(this).find("input")[0].checked||(e.addClass("h5p-hidden2"),t.addClass("h5p-hidden2"),i.addClass("h5p-hidden2"),r.addClass("h5p-hidden2")),ns.$(this).find("input").change((function(n){n.target.checked?(e.removeClass("h5p-hidden2"),t.removeClass("h5p-hidden2"),i.removeClass("h5p-hidden2"),t.find("input")[0].checked&&r.removeClass("h5p-hidden2")):(e.addClass("h5p-hidden2"),t.addClass("h5p-hidden2"),i.addClass("h5p-hidden2"),r.addClass("h5p-hidden2"))}))})),s.$form.find(".field-name-useButtonIcon").each((function(){var e=ns.$(this).parent().find(".field-name-buttonIcon");ns.$(this).find("input")[0].checked||e.addClass("h5p-hidden2"),ns.$(this).find("input").change((function(t){t.target.checked?e.removeClass("h5p-hidden2"):e.addClass("h5p-hidden2")}))}));var l=s.children[4];if(!(l instanceof r.None)){var c=function(){"image"===l.children[0].field.type?l.children[0].changes.push((function(t){i.setImageSize(s,e,t)})):"video"===l.children[0].field.type&&l.children[0].changes.push((function(t){i.setVideoSize(e,t)}));var n=r.CoursePresentation.findField("action",a).options;n=n.length>0&&"object"==typeof n[0]&&(n=n.filter((function(e){return e.name.split(" ")[0]===t}))).length>0?n[0]:{}};void 0===l.children?l.changes.push(c):c()}return s},r.CoursePresentation.prototype.setImageSize=function(e,t,i){if(void 0!==i&&void 0!==i.width&&void 0!==i.height){var r=parseInt(e.$wrapper.css("font-size"))+e.$wrapper.outerWidth()-e.$wrapper.innerWidth(),n=i.width/i.height;i.width<r&&(i.height=r*n),i.height<r&&(i.height=r);var a=i.height/(this.cp.$current.innerHeight()/100);a<t.height&&(t.height=a),t.width=t.height*n,t.width>e.$wrapper.innerWidth()&&(t.height=e.$wrapper.innerWidth()*t.height/t.width,t.width=e.$wrapper.innerWidth()),t.height>e.$wrapper.innerHeight()&&(t.width=e.$wrapper.innerHeight()*t.width/t.height,t.height=e.$wrapper.innerHeight()),t.width=t.width/e.$wrapper.innerWidth()*100,t.height=t.height/e.$wrapper.innerHeight()*100}},r.CoursePresentation.prototype.setVideoSize=function(e,t){if(void 0===t)return;!0!==t.hasOwnProperty("aspectRatio")&&(t.aspectRatio="16:9");const i=this.cp.$current.innerWidth()/this.cp.$current.innerHeight(),r=String(t.aspectRatio).split(":");e.height=e.width*(1===r.length?t.aspectRatio:r[1]/r[0])*i},r.CoursePresentation.prototype.hideFields=function(e,t){for(var i=0;i<t.length;i++){var n=r.CoursePresentation.findField(t[i],e);n&&(n.widget="none")}},r.CoursePresentation.prototype.showFields=function(e,t){for(var i=0;i<e.length;i++){for(var r=e[i],n=!1,a=0;a<t.length;a++)if(r.name===t[a]){n=!0;break}n||(r.widget="none")}},r.CoursePresentation.prototype.findLibraryTitle=function(e,t){var i=this,r=function(){for(var r=0;r<i.libraries.length;r++)if(i.libraries[r].name===e)return void t(i.libraries[r].title)};void 0===i.libraries?i.once("librariesReady",r):r()},r.CoursePresentation.prototype.processElement=function(e,t,i,r){var n,a=this;n=void 0!==e.action?e.action.library.split(" ")[0]:"goToSlide";var o=t.index();void 0===this.elements[i]&&(this.elements[i]=[]),void 0===this.elements[i][o]&&(this.elements[i][o]=this.generateForm(e,n));var s=this.elements[i][o];s.$wrapper=t,H5P.jQuery("<div/>",{class:"h5p-element-overlay"}).appendTo(t),a.dnb&&a.addToDragNBar(s,e),t.dblclick((function(){a.showElementForm(s,t,e)})),"H5P.ContinuousText"===n&&void 0===a.ct&&(a.ct={element:s,params:e}),e.pasted&&("H5P.ContinuousText"===n&&H5P.ContinuousText.Engine.run(this),delete e.pasted),r.onAdd&&r.onAdd(e,i)},r.CoursePresentation.prototype.addToDragNBar=function(e,t){var i=this,n=t.action?t.action.library.split(" ")[0]:null;const a={disableResize:t.displayAsButton,lock:"H5P.Chart"===n&&"pieChart"===t.action.params.graphMode,cornerLock:"H5P.Image"===n||"H5P.Shape"===n};"H5P.Shape"===n&&(a.minSize=3,"vertical-line"==t.action.params.type?a.directionLock="vertical":"horizontal-line"==t.action.params.type&&(a.directionLock="horizontal"));var o=H5P.DragNBar.clipboardify(r.CoursePresentation.clipboardKey,t,"action"),s=i.dnb.add(e.$wrapper,o,a);return s.contextMenu.on("contextMenuEdit",(function(){i.showElementForm(e,e.$wrapper,t)})),e.$wrapper.find("*").attr("tabindex","-1"),s.contextMenu.on("contextMenuRemove",(function(){confirm(r.t("H5PEditor.InteraktivTavle","confirmRemoveElement"))&&(r.Html&&r.Html.removeWysiwyg(),i.removeElement(e,e.$wrapper,void 0!==t.action&&"H5P.ContinuousText"===H5P.libraryFromString(t.action.library).machineName),i.dnb.blurAll())})),s.contextMenu.on("contextMenuBringToFront",(function(){var r=e.$wrapper.index(),n=i.cp.$current.index();e.$wrapper.appendTo(i.cp.$current);var a=i.params.slides[n].elements;a.splice(r,1),a.push(t),i.elements[n].splice(r,1),i.elements[n].push(e),i.cp.children[n].moveChild(r,i.cp.children[n].children.length-1)})),s.contextMenu.on("contextMenuSendToBack",(function(){var r=e.$wrapper.index(),n=i.cp.$current.index();e.$wrapper.prependTo(i.cp.$current);var a=i.params.slides[n].elements;a.splice(r,1),a.unshift(t),i.elements[n].splice(r,1),i.elements[n].unshift(e),i.cp.children[n].moveChild(r,0)})),s},r.CoursePresentation.prototype.removeElement=function(e,t,i){var n=this.cp.$current.index(),a=t.index(),o=this.cp.elementInstances[n][a],s=!!e.children.length;if(i){var d=this.getCTs(!1,!0);2===d.length?(s=!1,e===d[0].element&&2===d.length&&(d[1].params.action.params=d[0].params.action.params)):(delete this.params.ct,delete this.ct)}s&&r.removeChildren(e.children),o.onDelete&&o.onDelete(this.params,n,a),this.elements[n].splice(a,1),this.cp.elementInstances[n].splice(a,1),this.params.slides[n].elements.splice(a,1),this.cp.children[n].removeChild(a),t.remove(),i&&H5P.ContinuousText.Engine.run(this)},r.CoursePresentation.prototype.showElementForm=function(e,t,i){var n,a=this;void 0!==i.action&&(n=H5P.libraryFromString(i.action.library).machineName);var o="H5P.ContinuousText"===n;o&&a.ct&&(a.ct.element.$form.find(".text .ckeditor").first().html(a.params.ct),a.ct.params.action.params.text=a.params.ct),"H5P.InteractiveVideo"===n&&(e=a.generateForm(i,n));const s=function(i){i.preventRemove=!confirm(r.t("H5PEditor.InteraktivTavle","confirmRemoveElement")),i.preventRemove||(a.removeElement(e,t,o),a.dnb.blurAll(),a.dnb.preventPaste=!1)};a.on("formremove",s);const d=function(){for(var r=0;r<e.children.length;r++)e.children[r].validate();o?(a.params.ct=a.ct.params.action.params.text,H5P.ContinuousText.Engine.run(a),setTimeout((function(){a.dnb.focus(t)}),1)):a.redrawElement(t,e,i),a.dnb.preventPaste=!1};a.on("formdone",d);const l=function(){f&&h()};a.on("formopened",l);const c=function(){a.off("formremove",s),a.off("formdone",d),a.off("formclose",c),a.off("formopened",l)};a.on("formclose",c);const p=r.findField("action",e);var h=function(){H5P.jQuery(".ckeditor, .h5peditor-text",p.$myField).not(".h5p-editor-dialog .ckeditor, .h5p-editor-dialog .h5peditor-text, .h5p-dialog-box .ckeditor, .h5p-dialog-box .h5peditor-text",p.$myField).eq(0).focus()};let u,m,f=!1;void 0===p.currentLibrary&&void 0!==p.change?p.change((function(){f=!0,a.isFormOpen()&&h()})):f=!0,void 0===i.action&&(u=r.t("H5PEditor.InteraktivTavle","goToSlide"),m="gotoslide"),a.openForm(p,e.$form[0],null,u,m),void 0!==a.dnb&&(a.dnb.preventPaste=!0,setTimeout((function(){a.dnb.blurAll()}),0))},r.CoursePresentation.prototype.redrawElement=function(e,t,i,r){var n=e.index(),a=this.cp.$current.index(),o=this.params.slides[a].elements,s=this.elements[a],d=this.cp.elementInstances[a];r=void 0===r?s.length-1-n:r,i.action&&"H5P.Chart"===i.action.library.split(" ")[0]&&"pieChart"===i.action.params.graphMode&&(i.width=i.height/this.slideRatio),this.cp.children[a].removeChild(n),d.splice(n,1),o.splice(n,1),o.push(i),s.splice(n,1),s.push(t),e.remove();var l=this.cp.children[a].addChild(i).instance,c=this.cp.attachElement(i,l,this.cp.$current,a);this.fitElement(c,i),void 0!==(l=d[d.length-1]).preventResize&&!1!==l.preventResize||void 0===l.$||i.displayAsButton||H5P.trigger(l,"resize");var p=this;r===s.length-1-n&&setTimeout((function(){p.dnb.focus(c)}),1),r>0&&(r--,this.redrawElement(s[n].$wrapper,s[n],o[n],r))},r.CoursePresentation.prototype.fitElement=function(e,t){var i=this.dnb.getElementSizeNPosition(e),r=H5P.DragNBar.fitElementInside(i),n=i.containerWidth/100,a=i.containerHeight/100,o={};void 0!==r.width&&(t.width=r.width/n,o.width=t.width+"%"),void 0!==r.left&&(t.x=r.left/n,o.left=t.x+"%"),void 0!==r.height&&(t.height=r.height/a,o.height=t.height+"%"),void 0!==r.top&&(t.y=r.top/a,o.top=t.y+"%"),e.css(o)},r.CoursePresentation.prototype.getCTs=function(e,t){for(var i=this,r=[],n=0;n<i.elements.length;n++){var a=i.elements[n];if(i.params.slides[n]&&i.params.slides[n].elements)for(var o=0;void 0!==a&&o<a.length;o++){var s=a[o],d=i.params.slides[n].elements[o];if(void 0!==d.action&&"H5P.ContinuousText"===d.action.library.split(" ")[0]){if(r.push({element:s,params:d}),e)return r[0];if(t&&2===r.length)return r}}}return e?null:r},r.CoursePresentation.prototype.ready=function(e){this.passReadies?this.parent.ready(e):this.readies.push(e)},r.CoursePresentation.findField=function(e,t){for(var i=0;i<t.length;i++)if(t[i].name===e)return t[i]},r.CoursePresentation.RATIO_SURFACE=16/9,window.H5PEditor.widgets.coursepresentation=r.CoursePresentation})(),ns.widgets.disposableBoolean=function(e,t){function i(i,r,n,a){var o,s=this;t.call(s);var d=void 0!==n&&n;a(r,d),s.field=r,s.appendTo=function(t){void 0===o&&function(){var t='<input type="checkbox"'+(d?' checked="checked" disabled="disabled"':"")+" />";o=e(ns.createBooleanFieldMarkup(r,t)),d&&o.addClass("disabled");var i=o.find("input").on("change",(function(){confirm(H5PEditor.t("H5PEditor.CoursePresentation","activeSurfaceWarning"))?(d=i.is(":checked"),a(r,d),i.attr("disabled",!0),o.addClass("disabled"),s.trigger("checked")):i.attr("checked",!1)}))}(),o.appendTo(t)},s.validate=function(){return!0},s.remove=function(){o.detach()}}return i.prototype=Object.create(t.prototype),i.prototype.constructor=i,i}(H5P.jQuery,H5P.EventDispatcher);